"use strict";var e,t=(e=require("events"))&&"object"==typeof e&&"default"in e?e.default:e;function r(e,t,r,n,o,i,u){try{var a=e[i](u),c=a.value}catch(e){return void r(e)}a.done?t(c):Promise.resolve(c).then(n,o)}function n(e){return function(){var t=this,n=arguments;return new Promise((function(o,i){var u=e.apply(t,n);function a(e){r(u,o,i,a,c,"next",e)}function c(e){r(u,o,i,a,c,"throw",e)}a(void 0)}))}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?p(e):t}function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=c(e);if(t){var o=c(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return l(this,r)}}function f(e,t,r){return(f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=c(e)););return e}(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function b(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,o=!1,i=void 0;try{for(var u,a=e[Symbol.iterator]();!(n=(u=a.next()).done)&&(r.push(u.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(o)throw i}}return r}(e,t)||h(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e){return function(e){if(Array.isArray(e))return d(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||h(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){if(e){if("string"==typeof e)return d(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?d(e,t):void 0}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function g(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=h(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,u=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return u=e.done,e},e:function(e){a=!0,i=e},f:function(){try{u||null==r.return||r.return()}finally{if(a)throw i}}}}function v(e,t,r,n){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(n):void 0})}function w(e,t,r,n,o){var i={};return Object.keys(n).forEach((function(e){i[e]=n[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=r.slice().reverse().reduce((function(r,n){return n(e,t,r)||r}),i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}var O={}.hasOwnProperty,j={}.hasOwnProperty;module.exports=function(e){var r=e.NS,i=r.initializeMixin,s=r.meta,l=r.constant,h=r.method,d=r.patch;return["DelayableAddon",function(e){var r,R,_,x,k,D,P,E,J,N,Q,S;return function(e){var t=e.NS,r=t.DELAYED_JOB_COMMAND,n=t.RESQUE,i=t.RESQUE_EXECUTOR,s=(t.Facade,t.initializePatch),p=t.meta,l=t.method;t.Utils._,e.definePatch("/patches/FacadePatch.js",(function(e){var t,b,m,h,d;return s((d=h=function(e){a(s,e);var t=y(s);function s(){return o(this,s),t.apply(this,arguments)}return u(s,[{key:"initializeFacade",value:function(){f(c(s.prototype),"initializeFacade",this).apply(this,arguments),this.addCommand(r,"DelayedJobCommand"),this.addProxy(n,"MemoryResque"),this.addMediator(i,"MemoryResqueExecutor")}}]),s}(e),h.object={},w(b=d,"object",[p],(m=(m=Object.getOwnPropertyDescriptor(b,"object"))?m.value:void 0,{enumerable:!0,configurable:!0,writable:!0,initializer:function(){return m}}),b),w(b.prototype,"initializeFacade",[l],Object.getOwnPropertyDescriptor(b.prototype,"initializeFacade"),b.prototype),t=b))||t}))}(r=function(e){var t,r,n,i,u,c,s=e.NS,p=s.ResqueExecutor,l=s.MemoryExecutorMixin,f=s.initialize,b=s.partOf,m=s.meta,h=s.nameBy;f(t=(0,s.mixin)(l)(t=b(e)((c=u=function(e){a(r,e);var t=y(r);function r(){return o(this,r),t.apply(this,arguments)}return r}(p),u.__filename="/mediators/MemoryResqueExecutor.js",u.object={},w(r=c,"__filename",[h],(n=(n=Object.getOwnPropertyDescriptor(r,"__filename"))?n.value:void 0,{enumerable:!0,configurable:!0,writable:!0,initializer:function(){return n}}),r),w(r,"object",[m],(i=(i=Object.getOwnPropertyDescriptor(r,"object"))?i.value:void 0,{enumerable:!0,configurable:!0,writable:!0,initializer:function(){return i}}),r),t=r))||t)||t)}(r=function(e){var t,r,n,i,u,c,s=e.NS,p=s.Resque,l=s.MemoryResqueMixin,f=s.initialize,b=s.partOf,m=s.meta,h=s.nameBy,d=s.mixin;f(t=b(e)(t=d(l)((c=u=function(e){a(r,e);var t=y(r);function r(){return o(this,r),t.apply(this,arguments)}return r}(p),u.__filename="/proxies/MemoryResque.js",u.object={},w(r=c,"__filename",[h],(n=(n=Object.getOwnPropertyDescriptor(r,"__filename"))?n.value:void 0,{enumerable:!0,configurable:!0,writable:!0,initializer:function(){return n}}),r),w(r,"object",[m],(i=(i=Object.getOwnPropertyDescriptor(r,"object"))?i.value:void 0,{enumerable:!0,configurable:!0,writable:!0,initializer:function(){return i}}),r),t=r))||t)||t)}(r=function(e){var r=e.NS,i=r.DELAYED_JOB_RESULT,s=r.START_RESQUE,l=r.RESQUE,b=(r.RESQUE_EXECUTOR,r.ResqueExecutor,r.initializeMixin),m=r.meta,h=r.property,d=r.method,O=r.inject,R=r.Utils,_=(R._,R.genRandomAlphaNumbers);e.defineMixin("/mixins/MemoryExecutorMixin.js",(function(e){var r,R,x,k,D,P,E,J,N,Q,S;return r=O("Factory<".concat(l,">")),b((S=Q=function(e){a(w,e);var r,l,b,m,h,d=y(w);function w(){var e;o(this,w);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return v(e=d.call.apply(d,[this].concat(r)),"_timer",D,p(e)),v(e,"_isStopped",P,p(e)),v(e,"_definedProcessors",E,p(e)),v(e,"_concurrencyCount",J,p(e)),v(e,"_resqueFactory",N,p(e)),e}return u(w,[{key:"fullQueueName",value:function(e){return this.resque.fullQueueName(e)}},{key:"listNotificationInterests",value:function(){return[i,s]}},{key:"handleNotification",value:function(e){var t=e.getName(),r=e.getBody(),n=e.getType();switch(t){case i:this.getViewComponent().emit(n,r);break;case s:this.start()}}},{key:"onRegister",value:function(){for(var e,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];(e=f(c(w.prototype),"onRegister",this)).call.apply(e,[this].concat(n)),this.setViewComponent(new t),this._concurrencyCount={},this._definedProcessors={},this.defineProcessors()}},{key:"reDefineProcessors",value:(h=n(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.stop(),this._definedProcessors={},e.next=4,this.defineProcessors();case 4:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"defineProcessors",value:(m=n(regeneratorRuntime.mark((function e(){var t,r,o,i,u,a,c=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.resque.allQueues();case 2:t=e.sent,r=g(t),e.prev=4,r.s();case 6:if((o=r.n()).done){e.next=13;break}return i=o.value,u=i.name,a=i.concurrency,this.resque.fullQueueName(u),this.define(u,{concurrency:a},function(){var e=n(regeneratorRuntime.mark((function e(t,r){var n,o,i,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=_(32),c.getViewComponent().once(n,(function(e){return r(e)})),o=t.data,i=o.scriptName,u=o.data,c.send(i,u,n);case 4:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()),e.abrupt("continue",11);case 11:e.next=6;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(4),r.e(e.t0);case 18:return e.prev=18,r.f(),e.finish(18);case 21:case"end":return e.stop()}}),e,this,[[4,15,18,21]])}))),function(){return m.apply(this,arguments)})},{key:"onRemove",value:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];(e=f(c(w.prototype),"onRemove",this)).call.apply(e,[this].concat(r)),this.stop()}},{key:"cyclePart",value:(b=n(regeneratorRuntime.mark((function e(){var t,r,n,o,i,u,a,c,s,p,l,y,f,b,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this._definedProcessors,e.t0=regeneratorRuntime.keys(t);case 2:if((e.t1=e.t0()).done){e.next=38;break}if(r=e.t1.value,j.call(t,r)){e.next=6;break}return e.abrupt("continue",2);case 6:return n=t[r],o=n.listener,i=n.concurrency,u=this._concurrencyCount[r],a=Date.now(),e.next=11,this.resque.progressJobs(r);case 11:c=e.sent,s=g(c);try{for(s.s();!(p=s.n()).done;)l=p.value,a-l.startedAt<l.lockLifetime&&(l.status="scheduled")}catch(e){s.e(e)}finally{s.f()}return e.next=16,this.resque.pendingJobs(r);case 16:if(y=e.sent,!(null!=u&&u<i||null==u)){e.next=36;break}f=g(y),e.prev=19,f.s();case 21:if((b=f.n()).done){e.next=28;break}if((m=b.value).delayUntil<a&&o(m),!(u>=i)){e.next=26;break}return e.abrupt("break",28);case 26:e.next=21;break;case 28:e.next=33;break;case 30:e.prev=30,e.t2=e.catch(19),f.e(e.t2);case 33:return e.prev=33,f.f(),e.finish(33);case 36:e.next=2;break;case 38:this.recursion();case 39:case"end":return e.stop()}}),e,this,[[19,30,33,36]])}))),function(){return b.apply(this,arguments)})},{key:"recursion",value:(l=n(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._isStopped){e.next=2;break}return e.abrupt("return");case 2:this._timer=setTimeout(n(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return clearTimeout(t._timer),e.next=3,t.cyclePart();case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)}))),100);case 3:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"start",value:(r=n(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._isStopped=!1,e.next=3,this.recursion();case 3:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"stop",value:function(){this._isStopped=!0,null!=this._timer&&clearTimeout(this._timer)}},{key:"define",value:function(e,t,r){var n=this,o=t.concurrency;this._definedProcessors[e]={listener:function(t){var o;null==(o=n._concurrencyCount)[e]&&(o[e]=0),n._concurrencyCount[e]+=1,t.status="running",t.startedAt=Date.now(),r(t,(function(r){null!=r?(t.status="failed",t.reason=r):t.status="completed",n._concurrencyCount[e]-=1}))},concurrency:o}}},{key:"resque",get:function(){return this._resqueFactory()}}]),w}(e),Q.object={},w(x=S,"object",[m],(k=(k=Object.getOwnPropertyDescriptor(x,"object"))?k.value:void 0,{enumerable:!0,configurable:!0,writable:!0,initializer:function(){return k}}),x),D=w(x.prototype,"_timer",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=w(x.prototype,"_isStopped",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),E=w(x.prototype,"_definedProcessors",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),J=w(x.prototype,"_concurrencyCount",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w(x.prototype,"fullQueueName",[d],Object.getOwnPropertyDescriptor(x.prototype,"fullQueueName"),x.prototype),w(x.prototype,"listNotificationInterests",[d],Object.getOwnPropertyDescriptor(x.prototype,"listNotificationInterests"),x.prototype),w(x.prototype,"handleNotification",[d],Object.getOwnPropertyDescriptor(x.prototype,"handleNotification"),x.prototype),w(x.prototype,"onRegister",[d],Object.getOwnPropertyDescriptor(x.prototype,"onRegister"),x.prototype),w(x.prototype,"reDefineProcessors",[d],Object.getOwnPropertyDescriptor(x.prototype,"reDefineProcessors"),x.prototype),w(x.prototype,"defineProcessors",[d],Object.getOwnPropertyDescriptor(x.prototype,"defineProcessors"),x.prototype),w(x.prototype,"onRemove",[d],Object.getOwnPropertyDescriptor(x.prototype,"onRemove"),x.prototype),w(x.prototype,"cyclePart",[d],Object.getOwnPropertyDescriptor(x.prototype,"cyclePart"),x.prototype),w(x.prototype,"recursion",[d],Object.getOwnPropertyDescriptor(x.prototype,"recursion"),x.prototype),w(x.prototype,"start",[d],Object.getOwnPropertyDescriptor(x.prototype,"start"),x.prototype),w(x.prototype,"stop",[d],Object.getOwnPropertyDescriptor(x.prototype,"stop"),x.prototype),w(x.prototype,"define",[d],Object.getOwnPropertyDescriptor(x.prototype,"define"),x.prototype),N=w(x.prototype,"_resqueFactory",[r,h],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w(x.prototype,"resque",[h],Object.getOwnPropertyDescriptor(x.prototype,"resque"),x.prototype),R=x))||R}))}(r=function(e){var t=e.NS,r=t.DEFAULT_QUEUE,i=(t.Resque,t.initializeMixin),s=t.meta,l=t.property,b=t.method,m=t.Utils,h=m._;m.inflect,e.defineMixin("/mixins/MemoryResqueMixin.js",(function(e){var t,m,d,g,O,j,R;return i((R=j=function(e){a(P,e);var t,i,s,l,b,m,d,w,j,R,_,x,k,D=y(P);function P(){var e;o(this,P);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return v(e=D.call.apply(D,[this].concat(r)),"_jobs",g,p(e)),v(e,"_queues",O,p(e)),e}return u(P,[{key:"onRegister",value:function(){f(c(P.prototype),"onRegister",this).apply(this,arguments),this._queues={},this._jobs={};var e=this.fullQueueName(r);this._queues[e]={name:r,concurrency:1}}},{key:"onRemove",value:function(){for(var e in f(c(P.prototype),"onRemove",this).apply(this,arguments),this._queues)delete this._queues[e];for(var t in this._queues={},this._jobs)delete this._jobs[t];this._jobs={}}},{key:"ensureQueue",value:(k=n(regeneratorRuntime.mark((function e(t){var r,n,o,i=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.length>1&&void 0!==i[1]?i[1]:1,n=this.fullQueueName(t),null!=(o=this._queues[n])?(o.concurrency=r,this._queues[n]=o):this._queues[n]={name:t,concurrency:r},e.abrupt("return",{name:t,concurrency:r});case 5:case"end":return e.stop()}}),e,this)}))),function(e){return k.apply(this,arguments)})},{key:"getQueue",value:(x=n(regeneratorRuntime.mark((function e(t){var r,n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.fullQueueName(t),null==(n=this._queues[r])){e.next=7;break}return o=n.concurrency,e.abrupt("return",{name:t,concurrency:o});case 7:case"end":return e.stop()}}),e,this)}))),function(e){return x.apply(this,arguments)})},{key:"removeQueue",value:(_=n(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=this.fullQueueName(t),null!=this._queues[r]&&delete this._queues[r];case 3:case"end":return e.stop()}}),e,this)}))),function(e){return _.apply(this,arguments)})},{key:"allQueues",value:(R=n(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=h.values(this._queues),r=t.map((function(e){return{name:e.name,concurrency:e.concurrency}})),e.abrupt("return",r);case 3:case"end":return e.stop()}}),e,this)}))),function(){return R.apply(this,arguments)})},{key:"pushJob",value:(j=n(regeneratorRuntime.mark((function e(t,r,n,o){var i,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.fullQueueName(t),o=o||Date.now(),null==this._jobs[i]&&(this._jobs[i]=[]),u=this._jobs[i].push({queueName:i,data:{scriptName:r,data:n},delayUntil:o,status:"scheduled",lockLifetime:5e3,lockLimit:2}),e.abrupt("return",u-1);case 5:case"end":return e.stop()}}),e,this)}))),function(e,t,r,n){return j.apply(this,arguments)})},{key:"getJob",value:(w=n(regeneratorRuntime.mark((function e(t,r){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.fullQueueName(t),null==this._jobs[n]&&(this._jobs[n]=[]),e.abrupt("return",this._jobs[n][r]||null);case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return w.apply(this,arguments)})},{key:"deleteJob",value:(d=n(regeneratorRuntime.mark((function e(t,r){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=this.fullQueueName(t),null==this._jobs[o]&&(this._jobs[o]=[]),null!=this._jobs[o][r]?(delete this._jobs[o][r],n=!0):n=!1,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return d.apply(this,arguments)})},{key:"abortJob",value:(m=n(regeneratorRuntime.mark((function e(t,r){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.fullQueueName(t),null==this._jobs[n]&&(this._jobs[n]=[]),null!=(o=this._jobs[n][r])&&"scheduled"===o.status&&(o.status="failed",o.reason=new Error("Job has been aborted"));case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return m.apply(this,arguments)})},{key:"allJobs",value:(b=n(regeneratorRuntime.mark((function e(t){var r,n,o=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=o.length>1&&void 0!==o[1]?o[1]:null,n=this.fullQueueName(t),null==this._jobs[n]&&(this._jobs[n]=[]),e.abrupt("return",this._jobs[n].filter((function(e){return null==r||e.data.scriptName===r}))||[]);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return b.apply(this,arguments)})},{key:"pendingJobs",value:(l=n(regeneratorRuntime.mark((function e(t){var r,n,o=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=o.length>1&&void 0!==o[1]?o[1]:null,n=this.fullQueueName(t),null==this._jobs[n]&&(this._jobs[n]=[]),e.abrupt("return",this._jobs[n].filter((function(e){return null!=r?!(e.data.scriptName!==r||!h.includes(["scheduled","queued"],e.status)):!!h.includes(["scheduled","queued"],e.status)}))||[]);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"progressJobs",value:(s=n(regeneratorRuntime.mark((function e(t){var r,n,o=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=o.length>1&&void 0!==o[1]?o[1]:null,n=this.fullQueueName(t),null==this._jobs[n]&&(this._jobs[n]=[]),e.abrupt("return",this._jobs[n].filter((function(e){return null!=r?e.data.scriptName===r&&"running"===e.status:"running"===e.status}))||[]);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"completedJobs",value:(i=n(regeneratorRuntime.mark((function e(t){var r,n,o=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=o.length>1&&void 0!==o[1]?o[1]:null,n=this.fullQueueName(t),null==this._jobs[n]&&(this._jobs[n]=[]),e.abrupt("return",this._jobs[n].filter((function(e){return null!=r?e.data.scriptName===r&&"completed"===e.status:"completed"===e.status}))||[]);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"failedJobs",value:(t=n(regeneratorRuntime.mark((function e(t){var r,n,o=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=o.length>1&&void 0!==o[1]?o[1]:null,n=this.fullQueueName(t),null==this._jobs[n]&&(this._jobs[n]=[]),e.abrupt("return",this._jobs[n].filter((function(e){return null!=r?e.data.scriptName===r&&"failed"===e.status:"failed"===e.status}))||[]);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),P}(e),j.object={},w(m=R,"object",[s],(d=(d=Object.getOwnPropertyDescriptor(m,"object"))?d.value:void 0,{enumerable:!0,configurable:!0,writable:!0,initializer:function(){return d}}),m),g=w(m.prototype,"_jobs",[l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=w(m.prototype,"_queues",[l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w(m.prototype,"onRegister",[b],Object.getOwnPropertyDescriptor(m.prototype,"onRegister"),m.prototype),w(m.prototype,"onRemove",[b],Object.getOwnPropertyDescriptor(m.prototype,"onRemove"),m.prototype),w(m.prototype,"ensureQueue",[b],Object.getOwnPropertyDescriptor(m.prototype,"ensureQueue"),m.prototype),w(m.prototype,"getQueue",[b],Object.getOwnPropertyDescriptor(m.prototype,"getQueue"),m.prototype),w(m.prototype,"removeQueue",[b],Object.getOwnPropertyDescriptor(m.prototype,"removeQueue"),m.prototype),w(m.prototype,"allQueues",[b],Object.getOwnPropertyDescriptor(m.prototype,"allQueues"),m.prototype),w(m.prototype,"pushJob",[b],Object.getOwnPropertyDescriptor(m.prototype,"pushJob"),m.prototype),w(m.prototype,"getJob",[b],Object.getOwnPropertyDescriptor(m.prototype,"getJob"),m.prototype),w(m.prototype,"deleteJob",[b],Object.getOwnPropertyDescriptor(m.prototype,"deleteJob"),m.prototype),w(m.prototype,"abortJob",[b],Object.getOwnPropertyDescriptor(m.prototype,"abortJob"),m.prototype),w(m.prototype,"allJobs",[b],Object.getOwnPropertyDescriptor(m.prototype,"allJobs"),m.prototype),w(m.prototype,"pendingJobs",[b],Object.getOwnPropertyDescriptor(m.prototype,"pendingJobs"),m.prototype),w(m.prototype,"progressJobs",[b],Object.getOwnPropertyDescriptor(m.prototype,"progressJobs"),m.prototype),w(m.prototype,"completedJobs",[b],Object.getOwnPropertyDescriptor(m.prototype,"completedJobs"),m.prototype),w(m.prototype,"failedJobs",[b],Object.getOwnPropertyDescriptor(m.prototype,"failedJobs"),m.prototype),t=m))||t}))}(r=function(e){var t=e.NS,r=t.RESQUE,i=t.DELAYED_JOBS_QUEUE,c=(t.CoreObject,t.initializeMixin),s=t.meta,l=t.property,f=t.method,b=t.inject;e.defineMixin("/mixins/SaveDelayedJobsMixin.js",(function(e){var t,m,h,d,O,j,R;return t=b("Factory<".concat(r,">")),c((R=j=function(e){a(c,e);var t,r=y(c);function c(){var e;o(this,c);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return v(e=r.call.apply(r,[this].concat(n)),"_resqueFactory",O,p(e)),e}return u(c,[{key:"saveDelayeds",value:(t=n(regeneratorRuntime.mark((function e(){var t,r,n,o,u,a,c,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=g,e.next=3,this.resque.getDelayed();case 3:e.t1=e.sent,t=(0,e.t0)(e.t1),e.prev=5,t.s();case 7:if((r=t.n()).done){e.next=17;break}return n=r.value,o=n.queueName,u=n.scriptName,a=n.data,c=n.delay,e.next=12,this.resque.get(o||i);case 12:return s=e.sent,e.next=15,s.push(u,a,c);case 15:e.next=7;break;case 17:e.next=22;break;case 19:e.prev=19,e.t2=e.catch(5),t.e(e.t2);case 22:return e.prev=22,t.f(),e.finish(22);case 25:case"end":return e.stop()}}),e,this,[[5,19,22,25]])}))),function(){return t.apply(this,arguments)})},{key:"resque",get:function(){return this._resqueFactory()}}]),c}(e),j.object={},w(h=R,"object",[s],(d=(d=Object.getOwnPropertyDescriptor(h,"object"))?d.value:void 0,{enumerable:!0,configurable:!0,writable:!0,initializer:function(){return d}}),h),w(h.prototype,"saveDelayeds",[f],Object.getOwnPropertyDescriptor(h.prototype,"saveDelayeds"),h.prototype),O=w(h.prototype,"_resqueFactory",[t,l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w(h.prototype,"resque",[l],Object.getOwnPropertyDescriptor(h.prototype,"resque"),h.prototype),m=h))||m}))}(r=function(e){var t=e.NS,r=t.RESQUE,i=t.DELAYED_JOBS_QUEUE,c=t.DELAYED_JOB_COMMAND,s=(t.CoreObject,t.Proto),p=t.initializeMixin,l=t.meta,f=t.method,b=t.Utils._;e.defineMixin("/mixins/DelayableMixin.js",(function(e){var t,m,h,d,g;return p((g=d=function(e){a(l,e);var t,p=y(l);function l(){return o(this,l),p.apply(this,arguments)}return u(l,[{key:"delay",value:function(e){return new Proxy(this,{get:function(t,r,o){if("delay"===r)throw new Error("Method `delay` can not been delayed");if(!(r in t)||"function"!=typeof t[r])throw new Error("Method `".concat(b.isSymbol(r)?Symbol.keyFor(r):r,"` absent in class ").concat(t.name,".prototype"));var i=t.constructor,u=e||{};return n(regeneratorRuntime.mark((function e(){var n,o,a,c,s=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=s.length,o=new Array(n),a=0;a<n;a++)o[a]=s[a];return e.t0=t.moduleName(),e.next=4,i.replicateObject(t);case 4:return e.t1=e.sent,e.t2=r,e.t3=o,e.t4=u,c={moduleName:e.t0,replica:e.t1,methodName:e.t2,args:e.t3,opts:e.t4},e.next=11,i._delayJob(t,c,u);case 11:return e.abrupt("return",e.sent);case 12:case"end":return e.stop()}}),e)})))}})}}],[{key:"_delayJob",value:(t=n(regeneratorRuntime.mark((function e(t,n,o){var u,a,s,p,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=o.queue,a=t.Module.NS.Facade,s=a.getInstance(t.Module.name),p=s.getProxy(r),e.next=6,p.get(u||i);case 6:return l=e.sent,e.next=9,l.delay(c,n,o.delayUntil);case 9:case"end":return e.stop()}}),e)}))),function(e,r,n){return t.apply(this,arguments)})},{key:"delay",value:function(e){return new Proxy(this,{get:function(t,r,o){if("delay"===r)throw new Error("Method `delay` can not been delayed");if(!(r in t)||"function"!=typeof t[r])throw new Error("Method `".concat(b.isSymbol(r)?Symbol.keyFor(r):r,"` absent in class ").concat(t.name));var i=e||{};return n(regeneratorRuntime.mark((function e(){var n,o,u,a,c=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=c.length,o=new Array(n),u=0;u<n;u++)o[u]=c[u];return e.t0=t.moduleName(),e.next=4,s.replicateObject(t);case 4:return e.t1=e.sent,e.t2=r,e.t3=o,e.t4=i,a={moduleName:e.t0,replica:e.t1,methodName:e.t2,args:e.t3,opts:e.t4},e.next=11,t._delayJob(t,a,i);case 11:return e.abrupt("return",e.sent);case 12:case"end":return e.stop()}}),e)})))}})}}]),l}(e),d.object={},w(m=g,"object",[l],(h=(h=Object.getOwnPropertyDescriptor(m,"object"))?h.value:void 0,{enumerable:!0,configurable:!0,writable:!0,initializer:function(){return h}}),m),w(m,"_delayJob",[f],Object.getOwnPropertyDescriptor(m,"_delayJob"),m),w(m,"delay",[f],Object.getOwnPropertyDescriptor(m,"delay"),m),w(m.prototype,"delay",[f],Object.getOwnPropertyDescriptor(m.prototype,"delay"),m.prototype),t=m))||t}))}(r=function(e){var t,r,n,i,u,c,s=e.NS,p=s.Mediator,l=s.initialize,f=s.partOf,b=s.meta,m=s.nameBy;l(t=f(e)((c=u=function(e){a(r,e);var t=y(r);function r(){return o(this,r),t.apply(this,arguments)}return r}(p),u.__filename="/mediators/ResqueExecutor.js",u.object={},w(r=c,"__filename",[m],(n=(n=Object.getOwnPropertyDescriptor(r,"__filename"))?n.value:void 0,{enumerable:!0,configurable:!0,writable:!0,initializer:function(){return n}}),r),w(r,"object",[b],(i=(i=Object.getOwnPropertyDescriptor(r,"object"))?i.value:void 0,{enumerable:!0,configurable:!0,writable:!0,initializer:function(){return i}}),r),t=r))||t)}(r=function(e){var t,r,i,c,s,p,l=e.NS,f=l.DELAYED_JOB_RESULT,b=l.Proto,h=l.Command,d=l.assert,g=l.initialize,v=l.partOf,O=l.meta,j=l.method,R=l.nameBy;g(t=v(e)((p=s=function(e){a(c,e);var t,r,i=y(c);function c(){return o(this,c),i.apply(this,arguments)}return u(c,[{key:"body",value:(r=n(regeneratorRuntime.mark((function e(t){var r,n,o,i,u,a,c,s,p;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=t.moduleName,u=t.replica,a=t.methodName,c=t.args,u.multitonKey=this._multitonKey,s=this.ApplicationModule,d(i===s.name,"Job was defined with moduleName = `".concat(i,"`, but its Module = `").concat(s.name,"`")),e.t0=u.type,e.next="class"===e.t0?7:"instance"===e.t0?13:20;break;case 7:return e.next=9,b.restoreObject(s,u);case 9:return o=e.sent,e.next=12,(r=o)[a].apply(r,m(c));case 12:return e.abrupt("break",21);case 13:return p=s.NS[u.class],e.next=16,p.restoreObject(s,u);case 16:return o=e.sent,e.next=19,(n=o)[a].apply(n,m(c));case 19:return e.abrupt("break",21);case 20:throw new Error("Replica type must be `instance` or `class`");case 21:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"execute",value:(t=n(regeneratorRuntime.mark((function e(t){var r,n,o,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.getBody(),n=t.getType(),o=null,e.prev=3,e.next=6,this.body(r);case 6:i=e.sent,o={result:i},e.next=15;break;case 10:e.prev=10,e.t0=e.catch(3),e.t0.message="ERROR in Script::execute "+e.t0.message,console.error(e.t0),o={error:e.t0};case 15:this.send(f,o,n);case 16:case"end":return e.stop()}}),e,this,[[3,10]])}))),function(e){return t.apply(this,arguments)})}]),c}(h),s.__filename="/commands/DelayedJobCommand.js",s.object={},w(r=p,"__filename",[R],(i=(i=Object.getOwnPropertyDescriptor(r,"__filename"))?i.value:void 0,{enumerable:!0,configurable:!0,writable:!0,initializer:function(){return i}}),r),w(r,"object",[O],(c=(c=Object.getOwnPropertyDescriptor(r,"object"))?c.value:void 0,{enumerable:!0,configurable:!0,writable:!0,initializer:function(){return c}}),r),w(r.prototype,"body",[j],Object.getOwnPropertyDescriptor(r.prototype,"body"),r.prototype),w(r.prototype,"execute",[j],Object.getOwnPropertyDescriptor(r.prototype,"execute"),r.prototype),t=r))||t)}(r=function(e){var t,r,i,s,l,m,h,d,O=e.NS,j=O.DELAYED_JOBS_QUEUE,R=O.Proxy,_=O.assert,x=O.initialize,k=O.partOf,D=O.meta,P=O.property,E=O.method,J=O.nameBy,N=(O.mixin,O.Utils.uuid);x(t=k(e)((d=h=function(t){a(T,t);var r,i,s,h,d,w,O,R,x,k,D,P,E,J,Q,S,q,z,A,U,M=y(T);function T(){var e;return o(this,T),v(e=M.apply(this,arguments),"_resqueI",l,p(e)),v(e,"tmpJobs",m,p(e)),e.tmpJobs=[],e}return u(T,[{key:"fullQueueName",value:function(e){if(!/\|\>/.test(e)){var t=b(this.ApplicationModule.name.split("|>"),1)[0];e="".concat(t,"|>").concat(e)}return e}},{key:"onRegister",value:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];(e=f(c(T.prototype),"onRegister",this)).call.apply(e,[this].concat(r))}},{key:"onRemove",value:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];(e=f(c(T.prototype),"onRemove",this)).call.apply(e,[this].concat(r)),this.tmpJobs=[]}},{key:"create",value:(U=n(regeneratorRuntime.mark((function t(r,n){var o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.ensureQueue(r,n);case 2:return o=t.sent,t.abrupt("return",e.NS.Queue.new(o,this));case 4:case"end":return t.stop()}}),t,this)}))),function(e,t){return U.apply(this,arguments)})},{key:"all",value:(A=n(regeneratorRuntime.mark((function t(){var r,n,o,i,u;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=[],t.next=3,this.allQueues();case 3:n=t.sent,o=g(n);try{for(o.s();!(i=o.n()).done;)u=i.value,r.push(e.NS.Queue.new(u,this))}catch(e){o.e(e)}finally{o.f()}return t.abrupt("return",r);case 7:case"end":return t.stop()}}),t,this)}))),function(){return A.apply(this,arguments)})},{key:"get",value:(z=n(regeneratorRuntime.mark((function t(r){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getQueue(r);case 2:if(null==(n=t.sent)){t.next=7;break}return t.abrupt("return",e.NS.Queue.new(n,this));case 7:case"end":return t.stop()}}),t,this)}))),function(e){return z.apply(this,arguments)})},{key:"remove",value:(q=n(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.removeQueue(t);case 2:case"end":return e.stop()}}),e,this)}))),function(e){return q.apply(this,arguments)})},{key:"update",value:(S=n(regeneratorRuntime.mark((function t(r,n){var o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.ensureQueue(r,n);case 2:return o=t.sent,t.abrupt("return",e.NS.Queue.new(o,this));case 4:case"end":return t.stop()}}),t,this)}))),function(e,t){return S.apply(this,arguments)})},{key:"delay",value:(Q=n(regeneratorRuntime.mark((function e(t,r,n,o){var i,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!/\|\>/.test(this.facade._multitonKey)){e.next=5;break}i=N.v4(),this.tmpJobs.push({queueName:t,scriptName:r,data:n,delay:o,id:i}),e.next=11;break;case 5:return e.next=7,this.get(t||j);case 7:return u=e.sent,e.next=10,u.push(r,n,o);case 10:i=e.sent;case 11:return e.abrupt("return",i);case 12:case"end":return e.stop()}}),e,this)}))),function(e,t,r,n){return Q.apply(this,arguments)})},{key:"getDelayed",value:(J=n(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.tmpJobs);case 1:case"end":return e.stop()}}),e,this)}))),function(){return J.apply(this,arguments)})},{key:"ensureQueue",value:(E=n(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",_.fail("Not implemented specific method"));case 1:case"end":return e.stop()}}),e)}))),function(e,t){return E.apply(this,arguments)})},{key:"getQueue",value:(P=n(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",_.fail("Not implemented specific method"));case 1:case"end":return e.stop()}}),e)}))),function(e){return P.apply(this,arguments)})},{key:"removeQueue",value:(D=n(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",_.fail("Not implemented specific method"));case 1:case"end":return e.stop()}}),e)}))),function(e){return D.apply(this,arguments)})},{key:"allQueues",value:(k=n(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",_.fail("Not implemented specific method"));case 1:case"end":return e.stop()}}),e)}))),function(){return k.apply(this,arguments)})},{key:"pushJob",value:(x=n(regeneratorRuntime.mark((function e(t,r,n,o){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",_.fail("Not implemented specific method"));case 1:case"end":return e.stop()}}),e)}))),function(e,t,r,n){return x.apply(this,arguments)})},{key:"getJob",value:(R=n(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",_.fail("Not implemented specific method"));case 1:case"end":return e.stop()}}),e)}))),function(e,t){return R.apply(this,arguments)})},{key:"deleteJob",value:(O=n(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",_.fail("Not implemented specific method"));case 1:case"end":return e.stop()}}),e)}))),function(e,t){return O.apply(this,arguments)})},{key:"abortJob",value:(w=n(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",_.fail("Not implemented specific method"));case 1:case"end":return e.stop()}}),e)}))),function(e,t){return w.apply(this,arguments)})},{key:"allJobs",value:(d=n(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",_.fail("Not implemented specific method"));case 1:case"end":return e.stop()}}),e)}))),function(e,t){return d.apply(this,arguments)})},{key:"pendingJobs",value:(h=n(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",_.fail("Not implemented specific method"));case 1:case"end":return e.stop()}}),e)}))),function(e,t){return h.apply(this,arguments)})},{key:"progressJobs",value:(s=n(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",_.fail("Not implemented specific method"));case 1:case"end":return e.stop()}}),e)}))),function(e,t){return s.apply(this,arguments)})},{key:"completedJobs",value:(i=n(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",_.fail("Not implemented specific method"));case 1:case"end":return e.stop()}}),e)}))),function(e,t){return i.apply(this,arguments)})},{key:"failedJobs",value:(r=n(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",_.fail("Not implemented specific method"));case 1:case"end":return e.stop()}}),e)}))),function(e,t){return r.apply(this,arguments)})}]),T}(R),h.__filename="/proxies/Resque.js",h.object={},w(r=d,"__filename",[J],(i=(i=Object.getOwnPropertyDescriptor(r,"__filename"))?i.value:void 0,{enumerable:!0,configurable:!0,writable:!0,initializer:function(){return i}}),r),w(r,"object",[D],(s=(s=Object.getOwnPropertyDescriptor(r,"object"))?s.value:void 0,{enumerable:!0,configurable:!0,writable:!0,initializer:function(){return s}}),r),l=w(r.prototype,"_resqueI",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"ResqueInterface"}}),m=w(r.prototype,"tmpJobs",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w(r.prototype,"fullQueueName",[E],Object.getOwnPropertyDescriptor(r.prototype,"fullQueueName"),r.prototype),w(r.prototype,"onRegister",[E],Object.getOwnPropertyDescriptor(r.prototype,"onRegister"),r.prototype),w(r.prototype,"onRemove",[E],Object.getOwnPropertyDescriptor(r.prototype,"onRemove"),r.prototype),w(r.prototype,"create",[E],Object.getOwnPropertyDescriptor(r.prototype,"create"),r.prototype),w(r.prototype,"all",[E],Object.getOwnPropertyDescriptor(r.prototype,"all"),r.prototype),w(r.prototype,"get",[E],Object.getOwnPropertyDescriptor(r.prototype,"get"),r.prototype),w(r.prototype,"remove",[E],Object.getOwnPropertyDescriptor(r.prototype,"remove"),r.prototype),w(r.prototype,"update",[E],Object.getOwnPropertyDescriptor(r.prototype,"update"),r.prototype),w(r.prototype,"delay",[E],Object.getOwnPropertyDescriptor(r.prototype,"delay"),r.prototype),w(r.prototype,"getDelayed",[E],Object.getOwnPropertyDescriptor(r.prototype,"getDelayed"),r.prototype),w(r.prototype,"ensureQueue",[E],Object.getOwnPropertyDescriptor(r.prototype,"ensureQueue"),r.prototype),w(r.prototype,"getQueue",[E],Object.getOwnPropertyDescriptor(r.prototype,"getQueue"),r.prototype),w(r.prototype,"removeQueue",[E],Object.getOwnPropertyDescriptor(r.prototype,"removeQueue"),r.prototype),w(r.prototype,"allQueues",[E],Object.getOwnPropertyDescriptor(r.prototype,"allQueues"),r.prototype),w(r.prototype,"pushJob",[E],Object.getOwnPropertyDescriptor(r.prototype,"pushJob"),r.prototype),w(r.prototype,"getJob",[E],Object.getOwnPropertyDescriptor(r.prototype,"getJob"),r.prototype),w(r.prototype,"deleteJob",[E],Object.getOwnPropertyDescriptor(r.prototype,"deleteJob"),r.prototype),w(r.prototype,"abortJob",[E],Object.getOwnPropertyDescriptor(r.prototype,"abortJob"),r.prototype),w(r.prototype,"allJobs",[E],Object.getOwnPropertyDescriptor(r.prototype,"allJobs"),r.prototype),w(r.prototype,"pendingJobs",[E],Object.getOwnPropertyDescriptor(r.prototype,"pendingJobs"),r.prototype),w(r.prototype,"progressJobs",[E],Object.getOwnPropertyDescriptor(r.prototype,"progressJobs"),r.prototype),w(r.prototype,"completedJobs",[E],Object.getOwnPropertyDescriptor(r.prototype,"completedJobs"),r.prototype),w(r.prototype,"failedJobs",[E],Object.getOwnPropertyDescriptor(r.prototype,"failedJobs"),r.prototype),t=r))||t)}(r=function(e){var t,r,i,s,l,b,m,h,d,g=e.NS,j=g.CoreObject,R=g.initialize,_=g.partOf,x=g.meta,k=g.property,D=g.method,P=g.nameBy;R(t=_(e)((d=h=function(e){a(D,e);var t,r,i,s,h,d,g,w,j,R,_,x,k=y(D);function D(e,t){var r;for(var n in o(this,D),v(r=k.apply(this,arguments),"resque",l,p(r)),v(r,"name",b,p(r)),v(r,"concurrency",m,p(r)),r.resque=t,e)if(O.call(e,n)){var i=e[n];r[n]=i}return r}return u(D,[{key:"delay",value:(x=n(regeneratorRuntime.mark((function e(t,r,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.resque.delay(this.name,t,r,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return x.apply(this,arguments)})},{key:"push",value:(_=n(regeneratorRuntime.mark((function e(t,r,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.resque.pushJob(this.name,t,r,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return _.apply(this,arguments)})},{key:"get",value:(R=n(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.resque.getJob(this.name,t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return R.apply(this,arguments)})},{key:"delete",value:(j=n(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.resque.deleteJob(this.name,t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return j.apply(this,arguments)})},{key:"abort",value:(w=n(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.resque.abortJob(this.name,t);case 2:case"end":return e.stop()}}),e,this)}))),function(e){return w.apply(this,arguments)})},{key:"all",value:(g=n(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.resque.allJobs(this.name,t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return g.apply(this,arguments)})},{key:"pending",value:(d=n(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.resque.pendingJobs(this.name,t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"progress",value:(h=n(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.resque.progressJobs(this.name,t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)})},{key:"completed",value:(s=n(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.resque.completedJobs(this.name,t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"failed",value:(i=n(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.resque.failedJobs(this.name,t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})}],[{key:"restoreObject",value:(r=n(regeneratorRuntime.mark((function e(t,r){var n,o,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((null!=r?r.class:void 0)!==this.name||"instance"!==(null!=r?r.type:void 0)){e.next=9;break}return n=t.NS.ApplicationFacade||t.NS.Facade,o=n.getInstance(r.multitonKey),i=o.getProxy(r.resqueName),e.next=6,i.get(r.name);case 6:return e.abrupt("return",e.sent);case 9:return e.next=11,f(c(D),"restoreObject",this).call(this,t,r);case 11:return e.abrupt("return",e.sent);case 12:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"replicateObject",value:(t=n(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f(c(D),"replicateObject",this).call(this,t);case 2:return(r=e.sent).multitonKey=t.resque._multitonKey,r.resqueName=t.resque.getProxyName(),r.name=t.name,e.abrupt("return",r);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),D}(j),h.__filename="/queue/Queue.js",h.object={},w(r=d,"__filename",[P],(i=(i=Object.getOwnPropertyDescriptor(r,"__filename"))?i.value:void 0,{enumerable:!0,configurable:!0,writable:!0,initializer:function(){return i}}),r),w(r,"object",[x],(s=(s=Object.getOwnPropertyDescriptor(r,"object"))?s.value:void 0,{enumerable:!0,configurable:!0,writable:!0,initializer:function(){return s}}),r),l=w(r.prototype,"resque",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=w(r.prototype,"name",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),m=w(r.prototype,"concurrency",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w(r.prototype,"delay",[D],Object.getOwnPropertyDescriptor(r.prototype,"delay"),r.prototype),w(r.prototype,"push",[D],Object.getOwnPropertyDescriptor(r.prototype,"push"),r.prototype),w(r.prototype,"get",[D],Object.getOwnPropertyDescriptor(r.prototype,"get"),r.prototype),w(r.prototype,"delete",[D],Object.getOwnPropertyDescriptor(r.prototype,"delete"),r.prototype),w(r.prototype,"abort",[D],Object.getOwnPropertyDescriptor(r.prototype,"abort"),r.prototype),w(r.prototype,"all",[D],Object.getOwnPropertyDescriptor(r.prototype,"all"),r.prototype),w(r.prototype,"pending",[D],Object.getOwnPropertyDescriptor(r.prototype,"pending"),r.prototype),w(r.prototype,"progress",[D],Object.getOwnPropertyDescriptor(r.prototype,"progress"),r.prototype),w(r.prototype,"completed",[D],Object.getOwnPropertyDescriptor(r.prototype,"completed"),r.prototype),w(r.prototype,"failed",[D],Object.getOwnPropertyDescriptor(r.prototype,"failed"),r.prototype),w(r,"restoreObject",[D],Object.getOwnPropertyDescriptor(r,"restoreObject"),r),w(r,"replicateObject",[D],Object.getOwnPropertyDescriptor(r,"replicateObject"),r),t=r))||t)}(r=i((S=Q=function(e){a(r,e);var t=y(r);function r(){var e;o(this,r);for(var n=arguments.length,i=new Array(n),u=0;u<n;u++)i[u]=arguments[u];return v(e=t.call.apply(t,[this].concat(i)),"RESQUE",x,p(e)),v(e,"RESQUE_EXECUTOR",k,p(e)),v(e,"START_RESQUE",D,p(e)),v(e,"DELAYED_JOBS_QUEUE",P,p(e)),v(e,"DELAYED_JOB_COMMAND",E,p(e)),v(e,"DEFAULT_QUEUE",J,p(e)),v(e,"DELAYED_JOB_RESULT",N,p(e)),e}return u(r,null,[{key:"including",value:function(){d(this.NS.FacadePatch)(this.NS.Facade)}}]),r}(e),Q.object={},w(R=S,"object",[s],(_=(_=Object.getOwnPropertyDescriptor(R,"object"))?_.value:void 0,{enumerable:!0,configurable:!0,writable:!0,initializer:function(){return _}}),R),x=w(R.prototype,"RESQUE",[l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"ResqueProxy"}}),k=w(R.prototype,"RESQUE_EXECUTOR",[l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"ResqueExecutor"}}),D=w(R.prototype,"START_RESQUE",[l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"START_RESQUE"}}),P=w(R.prototype,"DELAYED_JOBS_QUEUE",[l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"delayed_jobs"}}),E=w(R.prototype,"DELAYED_JOB_COMMAND",[l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"DelayedJobCommand"}}),J=w(R.prototype,"DEFAULT_QUEUE",[l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"default"}}),N=w(R.prototype,"DELAYED_JOB_RESULT",[l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"DELAYED_JOB_RESULT"}}),w(R,"including",[h],Object.getOwnPropertyDescriptor(R,"including"),R),r=R))||r)||r)||r)||r)||r)||r)||r)||r)||r)||r)||r)||r}]};
